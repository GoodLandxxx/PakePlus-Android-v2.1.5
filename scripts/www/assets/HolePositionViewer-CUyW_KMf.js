import{d as J,u as K,h as O,i as Q,k as S,c as d,a as u,b as e,A as Z,w as c,F as k,r as P,t as g,n as _,o as l,f as r,v as y,x as tt,l as f,g as U,y as R,m as et,_ as st}from"./index-C-yXZlVN.js";import{F as b}from"./FormRow-DdkG5DgU.js";import{P as N}from"./PrimaryButton-CbN-5kpj.js";const it={class:"calculator-page"},nt={class:"content"},ot={class:"form-card"},lt={class:"holes-list"},at={class:"hole-header"},dt={class:"label"},ut={class:"checkbox-group"},ct={class:"fill-checkbox"},rt=["onUpdate:modelValue","onChange"],pt={class:"fill-checkbox"},mt=["onUpdate:modelValue","onChange"],gt=["onClick"],vt=["onUpdate:modelValue"],_t=["onUpdate:modelValue"],yt=["onUpdate:modelValue"],bt=["onUpdate:modelValue"],ft=["onUpdate:modelValue"],ht=["onUpdate:modelValue"],wt={class:"result-area"},xt={class:"visualization"},Vt={class:"vis-label"},kt={class:"guide-label"},Ct={class:"guide-label"},$t={class:"guide-label"},Ut={class:"guide-label"},Ft={class:"guide-label"},Gt={key:0,class:"hole-diam-label"},Xt={class:"vis-label-y"},St={class:"actions"},Yt=J({__name:"HolePositionViewer",setup(Bt){const H=K(),s=O({width:500,length:500}),x=Q([{x:100,y:100,d:20,isFill:!1,spacing:50,isCenter:!1,countX:1,countY:1}]),L=()=>{x.value.push({x:0,y:0,d:10,isFill:!1,spacing:0,isCenter:!1,countX:1,countY:1})},M=a=>{x.value.splice(a,1)},z=()=>{s.width=500,s.length=500,x.value=[{x:100,y:100,d:20}]},I=()=>{(!s.width||!s.length)&&H.showModal({title:"错误",content:"请输入板材尺寸",type:"warning"})},W=S(()=>({aspectRatio:"1",display:"flex",justifyContent:"center",alignItems:"center"})),j=S(()=>{const a=s.width||1,i=s.length||1,t=a/i;return t>=1?{width:"100%",aspectRatio:`${t}`}:{height:"100%",aspectRatio:`${t}`}}),A=S(()=>{const a=[],i=s.width||0,t=s.length||0;return x.value.forEach(o=>{if(o.d<=0)return;let n=o.x,h=o.y,w=0,C=0,p=o.spacing||0,F=!1;if(o.isCenter&&p>0&&(o.countX||0)>0&&(o.countY||0)>0){F=!0;const m=o.countX||1,V=o.countY||1,v=(m-1)*p,$=(V-1)*p;n=(i-v)/2,h=(t-$)/2,w=m,C=V}else if(o.isFill&&p>0)F=!0,n+o.d/2<=i&&(w=Math.floor((i-n-o.d/2)/p)+1),h+o.d/2<=t&&(C=Math.floor((t-h-o.d/2)/p)+1);else{a.push({...o,showGuides:!0});return}if(F)for(let m=0;m<w;m++){const V=n+m*p;for(let v=0;v<C;v++){const $=h+v*p,Y=m===0,B=v===0,E=m===1&&v===0,G=m===w-1,X=v===C-1,T=G&&B||G&&X,q=Y&&X||G&&X;a.push({x:Number(V.toFixed(2)),y:Number($.toFixed(2)),d:o.d,showGuides:Y&&B,showSpacing:E,spacingVal:p,showGuideRight:T,showGuideBottom:q,distRight:Number((i-V).toFixed(2)),distBottom:Number((t-$).toFixed(2))})}}}),a}),D=a=>{const i=s.width||1,t=s.length||1,o=a.x/i*100,n=a.y/t*100,h=a.d/i*100,w=a.d/t*100;return{left:`${o}%`,top:`${n}%`,width:`${h}%`,height:`${w}%`,borderRadius:"50%"}};return(a,i)=>(l(),d("div",it,[u(Z,{title:"打孔定位","show-arrow":""}),e("div",nt,[e("div",ot,[u(b,{label:"板材宽",unit:"mm"},{default:c(()=>[r(e("input",{"onUpdate:modelValue":i[0]||(i[0]=t=>s.width=t),type:"number"},null,512),[[y,s.width,void 0,{number:!0}]])]),_:1}),u(b,{label:"板材高",unit:"mm"},{default:c(()=>[r(e("input",{"onUpdate:modelValue":i[1]||(i[1]=t=>s.length=t),type:"number"},null,512),[[y,s.length,void 0,{number:!0}]])]),_:1})]),e("div",{class:"section-title"},[i[2]||(i[2]=e("span",null,"孔位设置",-1)),e("button",{class:"add-btn",onClick:L},"+ 添加孔")]),e("div",lt,[(l(!0),d(k,null,P(x.value,(t,o)=>(l(),d("div",{key:o,class:"hole-item"},[e("div",at,[e("span",dt,"孔 "+g(o+1),1),e("div",ut,[e("label",ct,[r(e("input",{type:"checkbox","onUpdate:modelValue":n=>t.isFill=n,onChange:n=>t.isFill&&(t.isCenter=!1)},null,40,rt),[[R,t.isFill]]),i[3]||(i[3]=U(" 打满 ",-1))]),e("label",pt,[r(e("input",{type:"checkbox","onUpdate:modelValue":n=>t.isCenter=n,onChange:n=>t.isCenter&&(t.isFill=!1)},null,40,mt),[[R,t.isCenter]]),i[4]||(i[4]=U(" 居中 ",-1))])]),e("span",{class:"remove-btn",onClick:n=>M(o)},"×",8,gt)]),t.isCenter?(l(),d(k,{key:1},[u(b,{label:"横孔数量：",unit:"个"},{default:c(()=>[r(e("input",{"onUpdate:modelValue":n=>t.countX=n,type:"number"},null,8,yt),[[y,t.countX,void 0,{number:!0}]])]),_:2},1024),u(b,{label:"竖孔数量：",unit:"个"},{default:c(()=>[r(e("input",{"onUpdate:modelValue":n=>t.countY=n,type:"number"},null,8,bt),[[y,t.countY,void 0,{number:!0}]])]),_:2},1024)],64)):(l(),d(k,{key:0},[u(b,{label:"X 坐标：",unit:"mm"},{default:c(()=>[r(e("input",{"onUpdate:modelValue":n=>t.x=n,type:"number",placeholder:"距左边距离"},null,8,vt),[[y,t.x,void 0,{number:!0}]])]),_:2},1024),u(b,{label:"Y 坐标：",unit:"mm"},{default:c(()=>[r(e("input",{"onUpdate:modelValue":n=>t.y=n,type:"number",placeholder:"距顶边距离"},null,8,_t),[[y,t.y,void 0,{number:!0}]])]),_:2},1024)],64)),t.isFill||t.isCenter?(l(),tt(b,{key:2,label:"孔心间距：",unit:"mm"},{default:c(()=>[r(e("input",{"onUpdate:modelValue":n=>t.spacing=n,type:"number"},null,8,ft),[[y,t.spacing,void 0,{number:!0}]])]),_:2},1024)):f("",!0),u(b,{label:"直 径：",unit:"mm"},{default:c(()=>[r(e("input",{"onUpdate:modelValue":n=>t.d=n,type:"number"},null,8,ht),[[y,t.d,void 0,{number:!0}]])]),_:2},1024)]))),128))]),e("div",wt,[e("div",xt,[e("div",Vt,g(s.width||0)+"mm",1),e("div",{class:"vis-box",style:_(W.value)},[e("div",{class:"vis-board",style:_(j.value)},[i[6]||(i[6]=e("div",{class:"origin-mark"},"0,0",-1)),(l(!0),d(k,null,P(A.value,(t,o)=>(l(),d(k,{key:o},[t.showGuides?(l(),d("div",{key:0,class:"vis-guide-x",style:_({top:`${t.y/(s.length||1)*100}%`,width:`${t.x/(s.width||1)*100}%`})},[e("span",kt,g(t.x),1)],4)):f("",!0),t.showGuides?(l(),d("div",{key:1,class:"vis-guide-y",style:_({left:`${t.x/(s.width||1)*100}%`,height:`${t.y/(s.length||1)*100}%`})},[e("span",Ct,g(t.y),1)],4)):f("",!0),t.showSpacing?(l(),d("div",{key:2,class:"vis-guide-spacing-x",style:_({left:`${(t.x-(t.spacingVal||0))/(s.width||1)*100}%`,top:`${t.y/(s.length||1)*100}%`,width:`${(t.spacingVal||0)/(s.width||1)*100}%`})},[e("span",$t,g(t.spacingVal),1)],4)):f("",!0),t.showGuideRight?(l(),d("div",{key:3,class:"vis-guide-right",style:_({right:0,top:`${t.y/(s.length||1)*100}%`,width:`${(s.width-t.x)/(s.width||1)*100}%`})},[e("span",Ut,g(t.distRight),1)],4)):f("",!0),t.showGuideBottom?(l(),d("div",{key:4,class:"vis-guide-bottom",style:_({bottom:0,left:`${t.x/(s.width||1)*100}%`,height:`${(s.length-t.y)/(s.length||1)*100}%`})},[e("span",Ft,g(t.distBottom),1)],4)):f("",!0),e("div",{class:et(["vis-hole",{"is-ghost":!t.showGuides&&!t.showSpacing&&!t.showGuideRight&&!t.showGuideBottom}]),style:_(D(t))},[i[5]||(i[5]=e("div",{class:"hole-center"},null,-1)),t.showGuides||t.showSpacing?(l(),d("div",Gt,"Φ"+g(t.d),1)):f("",!0)],6)],64))),128))],4)],4),e("div",Xt,g(s.length||0)+"mm",1)])]),e("div",St,[u(N,{type:"primary",onClick:I},{default:c(()=>[...i[7]||(i[7]=[U("刷新视图",-1)])]),_:1}),u(N,{type:"secondary",onClick:z},{default:c(()=>[...i[8]||(i[8]=[U("清空",-1)])]),_:1})])])]))}}),Ht=st(Yt,[["__scopeId","data-v-ed534668"]]);export{Ht as default};
