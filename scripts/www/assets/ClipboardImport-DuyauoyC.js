import{d as N,u as D,i as E,c as $,a as L,b as m,A as T,C as U,f as F,v as V,D as X,o as k,_ as A}from"./index-C-yXZlVN.js";import{u as O}from"./densityStore-BtvzsIEE.js";const B={class:"page-container"},J={class:"content"},R={class:"input-card"},z=N({__name:"ClipboardImport",setup(H){const y=X(),_=O(),h=D(),b=E(""),C=async()=>{try{const o=await navigator.clipboard.readText();b.value=o}catch(o){h.showModal({title:"é”™è¯¯",content:"æ— æ³•è¯»å–å‰ªåˆ‡æ¿ï¼Œè¯·å°è¯•æ‰‹åŠ¨ç²˜è´´",type:"error"}),console.error(o)}},S=()=>{try{const o=localStorage.getItem("machining_material_prices");return o?JSON.parse(o):[]}catch{return[]}},w=o=>{const t=_.densities.find(n=>n.name.toUpperCase()===o.toUpperCase());return t?t.density:.93},P=(o,t,n)=>{const i=o.filter(s=>s.name.toUpperCase()===t.toUpperCase());for(const s of i){const a=String(s.thickness).trim();if(a.includes("-")){const e=a.split("-").map(Number);if(e.length===2&&n>=e[0]&&n<=e[1])return Number(s.price)}else if(parseFloat(a)==n)return Number(s.price)}return 0},I=o=>{const t=o.trim();if(!t)return null;let n="PP",i=t;const s=t.search(/\d/);if(s===-1)return null;if(s>0){const d=t.substring(0,s).trim().match(/([a-zA-Z\u4e00-\u9fa5]+)/);d&&(n=d[0]),i=t.substring(s)}const a=/([\d\.]+)\s*(cm|mm)?\s*[\*xXÃ—]\s*([\d\.]+)\s*(cm|mm)?\s*[\*xXÃ—]\s*([\d\.]+)\s*(cm|mm)?/i,e=i.match(a);if(!e)return null;const r=(l,d)=>{let x=parseFloat(l);return d&&d.toLowerCase()==="cm"&&(x*=10),x},c=r(e[1]||"0",e[2]),f=r(e[3]||"0",e[4]),v=r(e[5]||"0",e[6]),p=[c,f,v];let g=1;const u=i.substring(e.index+e[0].length).trim();if(u){const l=u.match(/(\d+)\s*(?:ä»¶)?/);l&&(g=parseInt(l[1]))}return{material:n,dims:p,count:g,original:t}},M=()=>{const o=b.value.split(`
`),t=[],n=[],i=S();if(o.forEach(s=>{if(!s.trim())return;const a=I(s);if(a){const[e,r,c]=a.dims,f=w(a.material),v=Math.min(e,r,c),p=P(i,a.material,v),u=e*r*c*f/1e6*a.count,l=u*p,d={spec:`${a.material} ${e}x${r}x${c}mm (${a.count}ä»¶)`,density:f,weight:u.toFixed(2),price:p,amount:l.toFixed(2),createTime:new Date().toLocaleString(),_raw:{length:e,width:r,height:c,density:f,price:p,count:a.count},isImported:!0};t.unshift(d)}else n.push(s)}),t.length>0){let s=`æˆåŠŸè§£æ ${t.length} æ¡æ•°æ®ã€‚`;n.length>0&&(s+=`
æœ‰ ${n.length} æ¡æ— æ³•è§£æã€‚`),s+=`
å³å°†è·³è½¬åˆ°æ¿æè®¡ç®—é¡µé¢æŸ¥çœ‹ç»“æœã€‚`,h.showModal({title:"è§£ææˆåŠŸ",content:s,type:"success",showCancel:!0,confirmText:"å»æŸ¥çœ‹",cancelText:"å–æ¶ˆ",onConfirm:()=>{const a="history_rect_board",e=localStorage.getItem(a);let r=[];if(e)try{r=JSON.parse(e)}catch{}r.unshift(...t),localStorage.setItem(a,JSON.stringify(r)),y.push("/rect-board")}})}else h.showModal({title:"è§£æå¤±è´¥",content:"æœªèƒ½è§£æå‡ºæœ‰æ•ˆæ•°æ®ï¼Œè¯·æ£€æŸ¥æ ¼å¼ã€‚",type:"warning"})};return(o,t)=>(k(),$("div",B,[L(T,{title:"ä»å‰ªåˆ‡æ¿å¯¼å…¥","show-arrow":""}),m("div",J,[m("div",R,[t[1]||(t[1]=m("label",{class:"label"},"è¯·ç²˜è´´æ•°æ®",-1)),F(m("textarea",{"onUpdate:modelValue":t[0]||(t[0]=n=>b.value=n),placeholder:`ä¾‹å¦‚:
PE 550*65*30
PP 600x85x3
1165mmx565mmX5mm
600*135*3`,class:"text-area"},null,512),[[V,b.value]]),m("div",{class:"btn-group"},[m("button",{class:"action-btn secondary",onClick:C}," ğŸ“‹ ä»å‰ªåˆ‡æ¿è¯»å– "),m("button",{class:"action-btn primary",onClick:M}," ğŸš€ è§£æå¹¶è®¡ç®— ")])]),t[2]||(t[2]=U('<div class="tips" data-v-b5f2fe7b><h3 data-v-b5f2fe7b>æ”¯æŒæ ¼å¼è¯´æ˜</h3><p data-v-b5f2fe7b>æ¯ä¸€è¡Œä»£è¡¨ä¸€æ¡æ•°æ®ï¼Œæ ¼å¼çµæ´»æ”¯æŒï¼š</p><p data-v-b5f2fe7b><code data-v-b5f2fe7b>[æè´¨] é•¿*å®½*é«˜ [æ•°é‡]</code></p><p data-v-b5f2fe7b>ç¤ºä¾‹ï¼š</p><ul style="padding-left:20px;color:#666;font-size:13px;" data-v-b5f2fe7b><li data-v-b5f2fe7b><code data-v-b5f2fe7b>PE 550*65*30</code> (æè´¨PE, å°ºå¯¸mm)</li><li data-v-b5f2fe7b><code data-v-b5f2fe7b>PP 600x85x3</code> (åˆ†éš”ç¬¦æ”¯æŒ * x X Ã—)</li><li data-v-b5f2fe7b><code data-v-b5f2fe7b>1165mmx565mmX5mm</code> (æ··åˆåˆ†éš”ç¬¦ä¸å•ä½)</li><li data-v-b5f2fe7b><code data-v-b5f2fe7b>PP600CM*115cm*3 3ä»¶</code> (æ”¯æŒCMå•ä½ï¼Œæ•°é‡3)</li></ul></div>',1))])]))}}),W=A(z,[["__scopeId","data-v-b5f2fe7b"]]);export{W as default};
