import{d as U,u as B,h as f,i as v,j as T,p as I,c as p,a as n,b as a,A as R,l as $,w as i,F as D,r as O,o as h,f as d,v as c,t as _,g as w,_ as J}from"./index-C-yXZlVN.js";import{F as r}from"./FormRow-DdkG5DgU.js";import{S as L}from"./SelectDensity-DBYkwQsh.js";import{P as b}from"./PrimaryButton-CbN-5kpj.js";import{R as M}from"./ResultList-CBmffLVs.js";import"./densityStore-BtvzsIEE.js";const j={class:"calculator-page"},A={class:"content"},H={class:"form-card"},P={key:0,class:"specs-scroller"},E=["onClick"],q=["value"],z=["value"],G={class:"actions"},K=U({__name:"RectBoardCalculator",setup(Q){const S=B(),t=f({width:100,height:10,length:100,density:.93,price:10,count:1}),s=f({weight:"0.00",amount:"0.00"}),u=v([]),g=v([]),x=()=>{try{const o=localStorage.getItem("machining_common_specs");o&&(g.value=JSON.parse(o))}catch(o){console.error(o)}},V=o=>{t.width=o.width,t.length=o.length},C=()=>{if(!t.width||!t.height||!t.length||!t.density){S.showModal({title:"错误",content:"请填写完整尺寸和密度",type:"warning"});return}const e=(t.width*t.height*t.length*t.density/1e6*t.count).toFixed(2),l=(parseFloat(e)*t.price).toFixed(2);s.weight=e,s.amount=l,u.value.unshift({spec:`${t.length}x${t.width}x${t.height}mm (${t.count}件)`,density:t.density,weight:e,price:t.price,amount:l,createTime:new Date().toLocaleString(),_raw:{...t}})},k=o=>{o._raw&&(Object.assign(t,o._raw),s.weight=o.weight,s.amount=o.amount)},m=v(0);let y=null;const F=()=>{t.width=0,t.height=10,t.length=0,t.density=.93,t.price=0,t.count=1,s.weight="0.00",s.amount="0.00",m.value++,y&&clearTimeout(y),y=setTimeout(()=>{m.value=0},1e3),m.value>=3&&(u.value=[],m.value=0)};return T(()=>{x();const o=localStorage.getItem("history_rect_board");if(o)try{u.value=JSON.parse(o)}catch(e){console.error("Failed to load history",e)}}),I(u,o=>{localStorage.setItem("history_rect_board",JSON.stringify(o))},{deep:!0}),(o,e)=>(h(),p("div",j,[n(R,{title:"方料、板材","show-arrow":""}),a("div",A,[a("div",H,[n(r,{label:"长 度：",unit:"mm"},{default:i(()=>[d(a("input",{"onUpdate:modelValue":e[0]||(e[0]=l=>t.length=l),type:"number"},null,512),[[c,t.length,void 0,{number:!0}]])]),_:1}),n(r,{label:"宽 度：",unit:"mm"},{default:i(()=>[d(a("input",{"onUpdate:modelValue":e[1]||(e[1]=l=>t.width=l),type:"number"},null,512),[[c,t.width,void 0,{number:!0}]])]),_:1}),n(r,{label:"高 度：",unit:"mm"},{default:i(()=>[d(a("input",{"onUpdate:modelValue":e[2]||(e[2]=l=>t.height=l),type:"number"},null,512),[[c,t.height,void 0,{number:!0}]])]),_:1}),g.value.length>0?(h(),p("div",P,[(h(!0),p(D,null,O(g.value,(l,N)=>(h(),p("div",{key:N,class:"spec-tag",onClick:W=>V(l)},_(l.width)+"×"+_(l.length),9,E))),128))])):$("",!0),n(r,{label:"密 度：",unit:"g/cm³"},{default:i(()=>[n(L,{modelValue:t.density,"onUpdate:modelValue":e[3]||(e[3]=l=>t.density=l)},null,8,["modelValue"])]),_:1}),n(r,{label:"单 价：",unit:"元/千克"},{default:i(()=>[d(a("input",{"onUpdate:modelValue":e[4]||(e[4]=l=>t.price=l),type:"number"},null,512),[[c,t.price,void 0,{number:!0}]])]),_:1}),n(r,{label:"数 量：",unit:"件"},{default:i(()=>[d(a("input",{"onUpdate:modelValue":e[5]||(e[5]=l=>t.count=l),type:"number"},null,512),[[c,t.count,void 0,{number:!0}]])]),_:1}),n(r,{label:"重 量：",unit:"千克"},{default:i(()=>[a("input",{value:s.weight,type:"text",readonly:"",class:"readonly-input"},null,8,q)]),_:1}),n(r,{label:"金 额：",unit:"元"},{default:i(()=>[a("input",{value:s.amount,type:"text",readonly:"",class:"readonly-input"},null,8,z)]),_:1})]),n(M,{items:u.value,onSelect:k},null,8,["items"]),a("div",G,[n(b,{type:"secondary",onClick:F},{default:i(()=>[...e[6]||(e[6]=[w("清空",-1)])]),_:1}),n(b,{type:"primary",onClick:C},{default:i(()=>[...e[7]||(e[7]=[w("计算",-1)])]),_:1})])])]))}}),lt=J(K,[["__scopeId","data-v-a1c0a2f4"]]);export{lt as default};
